# =============================================================================
# Gwenn Agent Configuration
# Copy this to .env and fill in your values
# =============================================================================

# --- Claude API ---
# Option A: Anthropic API key (paid API plan)
# ANTHROPIC_API_KEY=  # leave unset to use Claude Code OAuth credentials

# Option B: Claude Code OAuth token (Claude Pro/Max via `claude` CLI)
# Leave ANTHROPIC_API_KEY unset to auto-detect from ~/.claude/.credentials.json
# Or set explicitly:
# ANTHROPIC_AUTH_TOKEN=sk-ant-oat01-your-oauth-token
# CLAUDE_CODE_OAUTH_TOKEN=sk-ant-oat01-your-oauth-token
#
# Notes:
# - If both ANTHROPIC_API_KEY and OAuth token are set, Gwenn uses ANTHROPIC_API_KEY.
# - Claude Code OAuth uses https://api.anthropic.com plus anthropic-beta: oauth-2025-04-20.
# - If you set ANTHROPIC_BASE_URL, ensure that header is forwarded.

GWENN_MODEL=claude-opus-4-6
GWENN_MAX_TOKENS=8192
GWENN_THINKING_BUDGET=16000

# --- Memory Persistence ---
GWENN_DATA_DIR=./gwenn_data
GWENN_EPISODIC_DB=./gwenn_data/gwenn.db
GWENN_SEMANTIC_DB=./gwenn_data/semantic_vectors
GWENN_RETRIEVAL_MODE=keyword
GWENN_EMBEDDING_TOP_K=25
GWENN_HYBRID_KEYWORD_WEIGHT=0.5
GWENN_HYBRID_EMBEDDING_WEIGHT=0.5
# 0 disables recent episode preload (unconsolidated episodes still load)
GWENN_STARTUP_EPISODE_LIMIT=5000
GWENN_SHUTDOWN_PERSIST_RECENT_EPISODES=0
# Persist semantic graph after each consolidation pass
GWENN_PERSIST_SEMANTIC_AFTER_CONSOLIDATION=True
GWENN_WM_EVICTION_TO_EPISODIC=False

# --- Heartbeat (sec)---
GWENN_HEARTBEAT_INTERVAL=30.0
GWENN_HEARTBEAT_MIN_INTERVAL=5.0
GWENN_HEARTBEAT_MAX_INTERVAL=120.0

# --- Affect ---
GWENN_AROUSAL_CEILING=0.92
GWENN_DISTRESS_THRESHOLD=0.80
GWENN_DISTRESS_DURATION_LIMIT=300

# --- Context Window ---
GWENN_CONTEXT_LIMIT=180000
GWENN_COMPACTION_TRIGGER=0.85
GWENN_WORKING_MEMORY_SLOTS=7

# --- Safety ---
GWENN_MAX_TOOL_ITERATIONS=25
GWENN_REQUIRE_APPROVAL_FOR=["file_write","shell_exec","web_request"]
GWENN_SANDBOX_ENABLED=True

# --- Privacy ---
GWENN_REDACTION_ENABLED=False
GWENN_REDACT_BEFORE_API=False
GWENN_REDACT_BEFORE_PERSIST=False

# --- Sensory Grounding (Layer 11) ---
GWENN_MAX_PERCEPTS_PER_CHANNEL=10
GWENN_PERCEPT_EXPIRY=300.0

# --- Ethical Reasoning (Layer 12) ---
GWENN_ETHICS_HISTORY_SIZE=100
GWENN_ETHICS_CONCERN_THRESHOLD=0.3

# --- Inter-Agent Communication (Layer 13) ---
GWENN_AGENT_ID=gwenn
GWENN_INTERAGENT_BUFFER_SIZE=100

# --- MCP ---
GWENN_MCP_SERVERS=[]

# =============================================================================
# Channel Configuration
# =============================================================================
# GWENN_CHANNEL=cli  (default — original terminal behavior)
# GWENN_CHANNEL=telegram | discord | all
GWENN_CHANNEL=cli

# --- Telegram (required if GWENN_CHANNEL=telegram or all) ---
# Obtain from @BotFather → /newbot
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
# JSON array of user IDs to whitelist ([] = public, no restriction)
TELEGRAM_ALLOWED_USER_IDS=[]
TELEGRAM_MAX_HISTORY_LENGTH=50

# --- Discord (required if GWENN_CHANNEL=discord or all) ---
# Obtain from Discord Developer Portal → Bot → Token
# Required intents: Message Content (enable in portal)
DISCORD_BOT_TOKEN=your_discord_bot_token_here
# JSON array of guild IDs to restrict to ([] = all guilds allowed)
DISCORD_ALLOWED_GUILD_IDS=[]
DISCORD_MAX_HISTORY_LENGTH=50
DISCORD_SESSION_TTL=3600.0
# Set to a guild ID for instant slash-command sync during development
DISCORD_SYNC_GUILD_ID=

# =============================================================================
# Daemon — Persistent Background Process
# =============================================================================
# Unix socket for CLI ↔ daemon communication
GWENN_DAEMON_SOCKET=./gwenn_data/gwenn.sock
GWENN_DAEMON_PID_FILE=./gwenn_data/gwenn.pid
# Optional shared token for daemon request authentication (recommended)
GWENN_DAEMON_AUTH_TOKEN=
# Channels the daemon manages: cli | cli,telegram | cli,discord | cli,telegram,discord
GWENN_DAEMON_CHANNELS=cli
GWENN_DAEMON_MAX_CONNECTIONS=10
GWENN_DAEMON_CONNECTION_TIMEOUT=300.0

# Session store (automatic conversation history for /resume)
GWENN_DAEMON_SESSIONS_DIR=./gwenn_data/sessions
GWENN_DAEMON_SESSION_MAX_COUNT=20
GWENN_DAEMON_SESSION_MAX_MESSAGES=200
# Show user-message previews in /resume listings (off by default to reduce data exposure)
GWENN_DAEMON_SESSION_INCLUDE_PREVIEW=False
# Redact PII-like patterns before persisting session transcripts
GWENN_DAEMON_REDACT_SESSION_CONTENT=True
